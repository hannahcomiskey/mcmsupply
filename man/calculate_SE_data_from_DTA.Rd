% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calculate_SE_data_from_DTA.R
\name{calculate_SE_data_from_DTA}
\alias{calculate_SE_data_from_DTA}
\title{Calculate Standard Errors and Variance-Covariance Matrices for DHS Subnational Estimates}
\usage{
calculate_SE_data_from_DTA(filepath, myresultsfolder)
}
\arguments{
\item{filepath}{Character string. The path to the DHS \code{.dta} file.}

\item{myresultsfolder}{Character string. Path to a folder where Excel
outputs will be saved. The function will create the required
subfolders (\verb{proportions/} and \verb{varcov/}) if they do not exist.}
}
\value{
A list with two elements (returned invisibly):
\describe{
\item{prop_mat}{Data frame of weighted estimates with counts}
\item{vcov_matrix}{Variance–covariance matrix tibble}
}
Output files are written to disk as a side effect.
}
\description{
This function reads a DHS dataset, constructs a survey design object,
computes weighted estimates of modern contraceptive method sources by
sector category, and exports both the proportion matrix and the
variance-covariance matrix to Excel files.
}
\details{
The function:
\enumerate{
\item Reads DHS survey microdata.
\item Constructs derived variables such as modern method, sector,
and method source.
\item Builds a survey design using \pkg{survey}.
\item Computes weighted proportions using \code{svyby()}.
\item Extracts the associated variance–covariance matrix.
\item Exports both datasets as Excel workbooks.
}
}
\examples{
\dontrun{
calculate_SE_data("data/country.dta", "results/")
}

}
