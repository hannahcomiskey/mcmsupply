---
title: "How to run a subnational level model for a single country"
author: "Hannah Comiskey"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load your library

```{r, include=TRUE, message=FALSE}
library(mcmsupply)
library(dplyr)
```

## Load the data 

```{r, include=TRUE, message=FALSE, warning=FALSE, eval=FALSE}
cleaned_natdata <- get_data(national=FALSE, local=TRUE, mycountry="Nepal", fp2030=TRUE, surveydata_filepath=NULL)
```

## Get the JAGS model inputs and the cleaned data

```{r, include=TRUE, message=FALSE, warning=FALSE, eval=FALSE}
pkg_data <- get_modelinputs(national=FALSE, local=TRUE, mycountry="Nepal", startyear=1990, endyear=2025.5, nsegments=12, raw_data = cleaned_natdata)

```

## Run JAGS model 

```{r, include=TRUE, message=FALSE, eval=FALSE}
run_jags_model(national=FALSE, jagsdata = pkg_data, jagsparams = NULL, local=TRUE, main_path = "results/subnational/local/", n_iter = 80000, n_burnin = 10000, n_thin = 35, mycountry="Nepal")
```

## Get posterior point estimates

```{r, include=TRUE, message=FALSE, eval=FALSE}
get_point_estimates(national=FALSE, main_path="results/subnational/local/", pkg_data, local=TRUE, mycountry="Nepal")
```

## Plot posterior point estimates with uncertainty

```{r, include=TRUE, message=FALSE, eval=FALSE}
plot_estimates(national=FALSE, main_path="results/subnational/local/", vis_path="visualisation/subnational/local/", pkg_data, local=TRUE, mycountry="Nepal") 
```
